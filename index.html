
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zoo Roulette - Cartoon</title>
    <style>
        /* --- 1. CORE --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body {
            margin: 0; padding: 0;
            background: #222; /* Outer border color */
            height: 100vh; width: 100vw;
            overflow: hidden;
            display: flex; justify-content: center; align-items: center;
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', sans-serif; /* Cartoon Font */
        }

        /* --- 2. GAME STAGE (Fixed Ratio 9:16) --- */
        #game-stage {
            position: relative;
            width: 100vh; height: 100vh; max-width: 100vw;
            aspect-ratio: 9/16;
            background: url('assets/bg_zoo.jpg') no-repeat center/cover;
            box-shadow: 0 0 30px black;
            overflow: hidden;
        }

        /* --- 3. RUNNING LIGHT TRACK (TOP) --- */
        /* Design: A rectangular loop of 24 boxes */
        .track-area {
            position: absolute; top: 8%; left: 5%; width: 90%; height: 35%;
            /* border: 2px solid yellow; Debug */
        }
        
        .track-box {
            position: absolute;
            width: 13.5%; height: 22%; /* Calculated size */
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            border: 2px solid rgba(255,255,255,0.5);
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }
        .track-box img { width: 85%; height: 85%; object-fit: contain; }

        /* The Selection Light */
        .highlight {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('assets/frame_light.png') no-repeat center/100% 100%;
            z-index: 10; filter: drop-shadow(0 0 10px orange);
            animation: pulse 0.2s infinite alternate;
        }
        @keyframes pulse { from{transform:scale(1);} to{transform:scale(1.05);} }

        /* --- 4. CENTER AREA (Timer & Shark) --- */
        .center-area {
            position: absolute; top: 16%; left: 16%; width: 68%; height: 20%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        
        .shark-jackpot {
            width: 90px; height: 90px;
            background: url('assets/icon_shark.png') no-repeat center/contain;
            filter: drop-shadow(0 5px 0 rgba(0,0,0,0.3));
            animation: float 3s ease-in-out infinite;
            cursor: pointer;
        }
        @keyframes float { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-10px);} }

        .timer-bubble {
            background: orange; border: 3px solid white;
            color: white; font-size: 24px; font-weight: bold;
            padding: 5px 20px; border-radius: 20px;
            margin-top: 10px; text-shadow: 0 2px 0 #cc5500;
            box-shadow: 0 4px 0 #cc5500;
        }

        /* --- 5. BETTING BUTTONS (BOTTOM) --- */
        .betting-grid {
            position: absolute; bottom: 15%; left: 5%; width: 90%; height: 35%;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 8px;
        }

        .bet-btn {
            position: relative;
            background: url('assets/btn_wood.png') no-repeat center/100% 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; transition: transform 0.1s;
            filter: drop-shadow(0 5px 0 #3e2723);
        }
        .bet-btn:active { transform: translateY(5px); filter: none; }

        .bet-icon { width: 70%; height: 70%; object-fit: contain; }
        .bet-multi { 
            position: absolute; top: -5px; right: -5px;
            background: red; color: white; font-size: 10px; padding: 2px 5px; 
            border-radius: 10px; border: 1px solid white; font-weight: bold;
        }
        .my-bet-badge {
            position: absolute; bottom: -5px; left: 50%; transform: translateX(-50%);
            background: gold; color: black; font-size: 11px; padding: 2px 8px;
            border-radius: 10px; border: 1px solid white; font-weight: bold;
            display: none;
        }

        /* --- 6. HUD (Chips & Balance) --- */
        .hud {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 12%;
            background: rgba(0,0,0,0.4); border-top: 2px solid rgba(255,255,255,0.3);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 15px; backdrop-filter: blur(5px);
        }

        .balance-pill {
            background: #333; border: 2px solid gold; border-radius: 25px;
            padding: 5px 15px; color: gold; font-weight: bold; font-size: 16px;
        }

        .chip-rack { display: flex; gap: 10px; }
        .chip {
            width: 45px; height: 45px; cursor: pointer; transition: 0.2s;
            background: url('assets/chip_10.png') no-repeat center/contain;
        }
        .chip.active { transform: scale(1.2); filter: drop-shadow(0 0 5px white); }

        /* --- 7. WIN OVERLAY --- */
        .win-modal {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); z-index: 100;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            display: none;
        }
        .win-banner { width: 80%; max-width: 300px; animation: bounceIn 0.5s; }
        .win-amount { font-size: 50px; color: gold; font-weight: 900; text-shadow: 0 3px 0 #000; margin-top: -40px; }
        @keyframes bounceIn { 0%{transform:scale(0);} 60%{transform:scale(1.2);} 100%{transform:scale(1);} }

    </style>
</head>
<body>

    <div id="game-stage">
        
        <div class="track-area" id="trackArea">
            </div>

        <div class="center-area">
            <div class="shark-jackpot" onclick="placeBet('shark', this)"></div>
            <div class="timer-bubble" id="timer">15</div>
        </div>

        <div class="betting-grid">
            <div class="bet-btn" onclick="placeBet('swallow', this)">
                <span class="bet-multi">6x</span><img src="assets/icon_swallow.png" class="bet-icon">
                <div class="my-bet-badge">0</div>
            </div>
            <div class="bet-btn" onclick="placeBet('pigeon', this)">
                <span class="bet-multi">8x</span><img src="assets/icon_pigeon.png" class="bet-icon">
                <div class="my-bet-badge">0</div>
            </div>
            <div class="bet-btn" onclick="placeBet('peacock', this)">
                <span class="bet-multi">8x</span><img src="assets/icon_peacock.png" class="bet-icon">
                <div class="my-bet-badge">0</div>
            </div>
            <div class="bet-btn" onclick="placeBet('eagle', this)">
                <span class="bet-multi">12x</span><img src="assets/icon_eagle.png" class="bet-icon">
                <div class="my-bet-badge">0</div>
            </div>

            <div class="bet-btn" onclick="placeBet('rabbit', this)">
                <span class="bet-multi">6x</span><img src="assets/icon_rabbit.png" class="bet-icon">
                <div class="my-bet-badge">0</div>
            </div>
            <div class="bet-btn" onclick="placeBet('monkey', this)">
                <span class="bet-multi">8x</span><img src="assets/icon_monkey.png" class="bet-icon">
                <div class="my-bet-badge">0</div>
            </div>
            <div class="bet-btn" onclick="placeBet('panda', this)">
                <span class="bet-multi">8x</span><img src="assets/icon_panda.png" class="bet-icon">
                <div class="my-bet-badge">0</div>
            </div>
            <div class="bet-btn" onclick="placeBet('lion', this)">
                <span class="bet-multi">12x</span><img src="assets/icon_lion.png" class="bet-icon">
                <div class="my-bet-badge">0</div>
            </div>
        </div>

        <div class="hud">
            <div class="balance-pill">PKR <span id="balance">50000</span></div>
            <div class="chip-rack">
                <div class="chip active" onclick="setChip(100)"></div>
                </div>
        </div>

        <div class="win-modal" id="winScreen">
            <img src="assets/win_banner.png" class="win-banner">
            <div class="win-amount" id="winVal">+0</div>
        </div>

    </div>

    <script>
        // --- LOGIC ---
        // Coordinates for the 24 box rectangular loop (Top, Right, Bottom, Left)
        // This is a simplified visual mapping for the grid 8x5 approximately
        
        // Loop Order: 24 items
        const trackPattern = [
            'swallow', 'rabbit', 'pigeon', 'monkey', 'peacock', 'panda', 'eagle', 'lion',
            'swallow', 'rabbit', 'pigeon', 'monkey', 'peacock', 'panda', 'eagle', 'lion',
            'swallow', 'rabbit', 'pigeon', 'monkey', 'shark', 'lion', 'eagle', 'peacock'
        ];

        const animalImg = {
            'swallow': 'assets/icon_swallow.png', 'rabbit': 'assets/icon_rabbit.png',
            'pigeon': 'assets/icon_pigeon.png', 'monkey': 'assets/icon_monkey.png',
            'peacock': 'assets/icon_peacock.png', 'panda': 'assets/icon_panda.png',
            'eagle': 'assets/icon_eagle.png', 'lion': 'assets/icon_lion.png',
            'shark': 'assets/icon_shark.png'
        };

        const multipliers = {
            'swallow':6, 'rabbit':6, 'pigeon':8, 'monkey':8, 
            'peacock':8, 'panda':8, 'eagle':12, 'lion':12, 'shark':100
        };

        let balance = 50000;
        let chipVal = 100;
        let bets = {};
        let gameState = 'BETTING';
        let timer = 15;
        let currentLight = 0;

        window.onload = () => {
            createTrack();
            startLoop();
        };

        // --- CREATE TRACK (VISUAL LOOP) ---
        function createTrack() {
            const area = document.getElementById('trackArea');
            // We need to position 24 boxes in a rectangle.
            // 7 top, 5 right, 7 bottom, 5 left (approx)
            
            // For simplicity in HTML/CSS without complex math, we use absolute % positions.
            const positions = [
                // Top Row (Left to Right)
                {l:0, t:0}, {l:14, t:0}, {l:28, t:0}, {l:42, t:0}, {l:56, t:0}, {l:70, t:0}, {l:84, t:0},
                // Right Col (Down)
                {l:84, t:25}, {l:84, t:50}, {l:84, t:75}, 
                // Bottom Row (Right to Left)
                {l:84, t:100}, {l:70, t:100}, {l:56, t:100}, {l:42, t:100}, {l:28, t:100}, {l:14, t:100}, {l:0, t:100},
                // Left Col (Up)
                {l:0, t:75}, {l:0, t:50}, {l:0, t:25}
            ];
            
            // Adjust pattern to match 20 slots (standard visual loop size) or repeat pattern
            // Let's fill 20 slots with the pattern
            
            for(let i=0; i<20; i++) {
                const animal = trackPattern[i % trackPattern.length];
                const div = document.createElement('div');
                div.className = 'track-box';
                div.id = `slot-${i}`;
                div.style.left = positions[i].l + '%';
                div.style.top = positions[i].t * 0.78 + '%'; // Scale height to fit
                
                const img = document.createElement('img');
                img.src = animalImg[animal];
                div.appendChild(img);
                area.appendChild(div);
                
                // Store animal data on element
                div.dataset.animal = animal;
            }
        }

        // --- BETTING ---
        function setChip(val) { chipVal = val; }

        function placeBet(animal, el) {
            if(gameState !== 'BETTING' || balance < chipVal) return;
            
            balance -= chipVal;
            if(!bets[animal]) bets[animal] = 0;
            bets[animal] += chipVal;
            
            document.getElementById('balance').innerText = balance;
            
            // Update UI
            const badge = el.querySelector('.my-bet-badge');
            if(badge) {
                badge.style.display = 'block';
                badge.innerText = bets[animal];
            }
        }

        // --- GAME LOOP ---
        function startLoop() {
            gameState = 'BETTING';
            timer = 15;
            bets = {};
            document.querySelectorAll('.my-bet-badge').forEach(e => e.style.display='none');
            document.getElementById('winScreen').style.display='none';
            
            const tInt = setInterval(() => {
                timer--;
                document.getElementById('timer').innerText = timer;
                if(timer<=0) {
                    clearInterval(tInt);
                    spin();
                }
            }, 1000);
        }

        function spin() {
            gameState = 'SPINNING';
            // Logic: Pick random slot 0-19
            const winIndex = Math.floor(Math.random() * 20);
            const totalSteps = (20 * 4) + winIndex; // 4 full rounds
            
            let step = 0;
            let current = 0;
            let speed = 50;

            function next() {
                // Clear old light
                const old = document.getElementById(`slot-${current}`);
                if(old.querySelector('.highlight')) old.querySelector('.highlight').remove();

                // Move next
                current = (current + 1) % 20;
                
                // Add Light
                const box = document.getElementById(`slot-${current}`);
                const h = document.createElement('div');
                h.className = 'highlight';
                box.appendChild(h);

                step++;
                
                // Friction
                if(totalSteps - step < 15) speed += 20;
                if(totalSteps - step < 5) speed += 50;

                if(step < totalSteps) {
                    setTimeout(next, speed);
                } else {
                    setTimeout(() => checkWin(box.dataset.animal), 1000);
                }
            }
            next();
        }

        function checkWin(winner) {
            const modal = document.getElementById('winScreen');
            
            let winAmt = 0;
            if(bets[winner]) winAmt = bets[winner] * multipliers[winner];

            document.getElementById('winVal').innerText = winAmt > 0 ? `+${winAmt}` : "TRY AGAIN";
            modal.style.display = 'flex';

            if(winAmt > 0) {
                balance += winAmt;
                document.getElementById('balance').innerText = balance;
            }

            setTimeout(startLoop, 3000);
        }

    </script>
</body>
</html>
