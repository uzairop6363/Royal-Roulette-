<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Royal Roulette - Casino Standard</title>
    <style>
        /* --- CORE --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0;
            background: #120505; /* Deep Casino Maroon */
            font-family: 'Arial', sans-serif;
            height: 100vh; width: 100vw;
            overflow: hidden;
            display: flex; flex-direction: column;
        }

        /* --- 1. FULL SCREEN TABLE --- */
        .table-view {
            width: 100%; height: 100%;
            position: absolute; top: 0; left: 0;
            /* Aapki nayi Dark Table Image */
            background: url('assets/table_dark.jpg') no-repeat center/100% 100%; 
            z-index: 10;
        }

        /* Betting Grid (Hidden Click Zones) */
        .grid-container {
            position: absolute; top: 15%; left: 5%; width: 90%; height: 65%;
            display: grid;
            grid-template-columns: 15% 1fr 1fr 1fr; /* Sidebar + 3 Cols */
            gap: 2px;
        }
        .click-zone { position: relative; } 
        /* Debugging ke liye border hata dia hai */
        
        .side-col { grid-column: 1; grid-row: span 4; } /* Left Bets */

        /* Chips on Table */
        .chip-placed {
            position: absolute; top: 50%; left: 50%; width: 22px; height: 22px;
            transform: translate(-50%, -50%) scale(0);
            animation: popIn 0.2s forwards; pointer-events: none;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.8)); z-index: 20;
        }
        @keyframes popIn { to { transform: translate(-50%, -50%) scale(1); } }

        /* --- 2. TIMER (TOP LEFT) --- */
        .timer-badge {
            position: absolute; top: 15px; left: 15px;
            width: 50px; height: 50px;
            background: rgba(0,0,0,0.6);
            border: 2px solid #ffd700; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            z-index: 50;
        }
        /* SVG Circle for Progress */
        .timer-svg { transform: rotate(-90deg); width: 100%; height: 100%; }
        .timer-circle {
            fill: none; stroke: #ffd700; stroke-width: 4;
            stroke-dasharray: 125; stroke-dashoffset: 0;
            transition: stroke-dashoffset 1s linear, stroke 0.3s;
        }
        .timer-text {
            position: absolute; color: #fff; font-weight: bold; font-size: 18px;
        }
        /* Red Alert Class */
        .timer-danger .timer-circle { stroke: #ff0000; }
        .timer-danger .timer-text { color: #ff0000; animation: pulse 0.5s infinite; }
        @keyframes pulse { 50% { opacity: 0.5; } }


        /* --- 3. CHIPS SIDEBAR (RIGHT SIDE) --- */
        .right-sidebar {
            position: absolute; right: 0; top: 20%; bottom: 15%;
            width: 70px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 50;
            padding-right: 5px;
        }

        .scroll-btn {
            width: 30px; height: 30px; background: rgba(0,0,0,0.5);
            border: 1px solid gold; border-radius: 50%;
            color: gold; font-size: 12px; display: flex; justify-content: center; align-items: center;
            cursor: pointer; margin: 5px 0;
        }

        .chip-stack {
            display: flex; flex-direction: column; gap: 12px;
            height: 300px; overflow-y: auto;
            align-items: center;
            /* Hide Scrollbar */
            scrollbar-width: none; -ms-overflow-style: none;
        }
        .chip-stack::-webkit-scrollbar { display: none; }

        .chip-selector {
            width: 55px; height: 55px; transition: 0.2s; cursor: pointer;
            opacity: 0.6; transform: scale(0.9);
        }
        .chip-selector img { width: 100%; height: 100%; object-fit: contain; }
        
        .chip-selector.active {
            opacity: 1; transform: scale(1.1) translateX(-5px);
            filter: drop-shadow(0 0 8px gold);
        }

        /* --- 4. BOTTOM STATS (TEXT ONLY) --- */
        .bottom-stats {
            position: absolute; bottom: 0; left: 0; width: 100%;
            height: 50px;
            background: linear-gradient(to top, #000 80%, transparent);
            display: flex; flex-direction: column; justify-content: flex-end;
            padding: 5px 15px; z-index: 60;
            pointer-events: none; /* Touches pass through */
        }

        .stat-row {
            font-size: 12px; font-weight: 500; margin-bottom: 3px;
            text-shadow: 0 1px 2px #000;
        }
        .label-white { color: #e0e0e0; margin-right: 5px; }
        .val-yellow { color: #ffcc00; font-weight: bold; font-family: monospace; }


        /* --- 5. WHEEL OVERLAY (POPUP) --- */
        .wheel-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 100;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.5s;
            backdrop-filter: blur(5px);
        }
        .wheel-overlay.show { opacity: 1; pointer-events: auto; }

        .wheel-group { position: relative; width: 300px; height: 300px; transform: scale(0.8); transition: 0.5s; }
        .wheel-overlay.show .wheel-group { transform: scale(1); }

        .wheel-img { position: absolute; top:0; left:0; width:100%; height:100%; }
        .spinner { transition: transform 4s cubic-bezier(0.1, 0.8, 0.1, 1); }
        .ball { 
            position: absolute; top: 12%; left: 50%; width: 12px; height: 12px; 
            background: white; border-radius: 50%; box-shadow: 0 0 5px white; 
            display: none; 
        }
        .pointer {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 25px solid gold;
            z-index: 10;
        }

        /* --- 6. WIN POPUP --- */
        .win-box {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            width: 250px; height: 120px;
            background: url('assets/win_popup.png') no-repeat center/contain;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 200; transition: 0.3s;
        }
        .win-num { font-size: 60px; color: #fff; font-weight: 900; text-shadow: 0 0 10px gold; margin:0; }

    </style>
</head>
<body>

    <div class="table-view">
        <div class="grid-container" id="grid">
            <div class="click-zone side-col" onclick="placeBet('left1', this)"></div>
            <div class="click-zone side-col" onclick="placeBet('left2', this)"></div>
            <div class="click-zone side-col" onclick="placeBet('left3', this)"></div>
            
            </div>
    </div>

    <div class="timer-badge" id="timerBadge">
        <svg class="timer-svg" viewBox="0 0 50 50">
            <circle class="timer-circle" cx="25" cy="25" r="20"></circle>
        </svg>
        <span class="timer-text" id="timerText">10</span>
    </div>

    <div class="right-sidebar">
        <div class="scroll-btn" onclick="scrollChips(-1)">▲</div>
        
        <div class="chip-stack" id="chipStack">
            <div class="chip-selector active" onclick="setChip(10, 'assets/chip_10.png', this)">
                <img src="assets/chip_10.png">
            </div>
            <div class="chip-selector" onclick="setChip(50, 'assets/chip_50.png', this)">
                <img src="assets/chip_50.png">
            </div>
            <div class="chip-selector" onclick="setChip(100, 'assets/chip_100.png', this)">
                <img src="assets/chip_100.png">
            </div>
            <div class="chip-selector" onclick="setChip(500, 'assets/chip_500.png', this)">
                <img src="assets/chip_500.png">
            </div>
            <div class="chip-selector" onclick="setChip(1000, 'assets/chip_1k.png', this)">
                <img src="assets/chip_1k.png">
            </div>
        </div>

        <div class="scroll-btn" onclick="scrollChips(1)">▼</div>
    </div>

    <div class="bottom-stats">
        <div class="stat-row">
            <span class="label-white">Total Bet</span>
            <span class="val-yellow">Rs<span id="totalBet">0</span></span>
        </div>
        <div class="stat-row">
            <span class="label-white">Balance</span>
            <span class="val-yellow">Rs<span id="balance">50000</span></span>
        </div>
    </div>

    <div class="wheel-overlay" id="wheelView">
        <div class="wheel-group">
            <div class="pointer"></div>
            <img src="assets/wheel_outer.png" class="wheel-img">
            <img src="assets/wheel_spinner.png" class="wheel-img spinner" id="spinner">
            <div class="ball" id="ball"></div>
        </div>
        
        <div class="win-box" id="winModal">
            <div class="win-num" id="winVal">0</div>
        </div>
    </div>

    <script>
        // --- GAME STATE ---
        let balance = 50000;
        let currentBet = 0;
        let currentChip = 10;
        let currentChipImg = 'assets/chip_10.png';
        let bets = {};
        let gameState = 'BETTING'; // BETTING or SPINNING
        let timerVal = 10;
        let timerInterval;

        // --- INIT ---
        window.onload = () => {
            initGrid();
            startTimer();
        };

        function initGrid() {
            const grid = document.getElementById('grid');
            // Generate 36 Number Spots
            for(let i=1; i<=36; i++) {
                const div = document.createElement('div');
                div.className = 'click-zone';
                // div.style.border = '1px solid rgba(255,255,255,0.1)'; // Debug
                div.onclick = function() { placeBet(i, this); };
                grid.appendChild(div);
            }
        }

        // --- TIMER LOGIC ---
        function startTimer() {
            gameState = 'BETTING';
            timerVal = 10;
            document.getElementById('wheelView').classList.remove('show');
            document.getElementById('winModal').style.transform = "translate(-50%, -50%) scale(0)";
            
            // Clear Chips from Table
            document.querySelectorAll('.chip-placed').forEach(c => c.remove());
            bets = {};
            currentBet = 0;
            document.getElementById('totalBet').innerText = "0";

            updateTimerUI();

            timerInterval = setInterval(() => {
                timerVal--;
                updateTimerUI();

                if(timerVal <= 0) {
                    clearInterval(timerInterval);
                    startSpinSequence();
                }
            }, 1000);
        }

        function updateTimerUI() {
            const text = document.getElementById('timerText');
            const badge = document.getElementById('timerBadge');
            const circle = document.querySelector('.timer-circle');
            
            text.innerText = timerVal;
            
            // Progress Circle Logic (125 is circumference approx)
            const offset = 125 - (timerVal / 10) * 125;
            circle.style.strokeDashoffset = offset;

            if(timerVal <= 3) {
                badge.classList.add('timer-danger');
            } else {
                badge.classList.remove('timer-danger');
            }
        }

        // --- BETTING LOGIC ---
        function setChip(val, img, el) {
            currentChip = val;
            currentChipImg = img;
            document.querySelectorAll('.chip-selector').forEach(x => x.classList.remove('active'));
            el.classList.add('active');
        }

        function scrollChips(dir) {
            const stack = document.getElementById('chipStack');
            stack.scrollBy({ top: dir * 50, behavior: 'smooth' });
        }

        function placeBet(target, el) {
            if(gameState !== 'BETTING') return;
            if(balance < currentChip) { alert("Low Balance"); return; }

            // Update Math
            balance -= currentChip;
            currentBet += currentChip;
            
            if(!bets[target]) bets[target] = 0;
            bets[target] += currentChip;

            updateUI();

            // Visual Chip
            const chip = document.createElement('img');
            chip.src = currentChipImg;
            chip.className = 'chip-placed';
            // Random Scatter for realism
            chip.style.transform = `translate(-50%, -50%) translate(${Math.random()*5-2}px, ${Math.random()*5-2}px)`;
            el.appendChild(chip);
        }

        function updateUI() {
            document.getElementById('balance').innerText = balance;
            document.getElementById('totalBet').innerText = currentBet;
        }

        // --- SPIN LOGIC ---
        function startSpinSequence() {
            gameState = 'SPINNING';
            
            // Show Wheel Overlay
            document.getElementById('wheelView').classList.add('show');

            const spinner = document.getElementById('spinner');
            const ball = document.getElementById('ball');
            const result = Math.floor(Math.random() * 37);

            // Wheel Animation
            const deg = 1440 + Math.random() * 360;
            spinner.style.transform = `rotate(${deg}deg)`;

            // Ball Animation
            ball.style.display = 'block';
            ball.animate([
                { transform: 'rotate(0deg) translateY(100px)' },
                { transform: `rotate(-${deg + 120}deg) translateY(60px)` }
            ], { duration: 4000, easing: 'cubic-bezier(0.2,0.8,0.1,1)', fill: 'forwards' });

            // Result after 4.5s
            setTimeout(() => {
                showWin(result);
            }, 4500);
        }

        function showWin(num) {
            const modal = document.getElementById('winModal');
            document.getElementById('winVal').innerText = num;
            modal.style.transform = "translate(-50%, -50%) scale(1)";

            // Calculate Win
            let winAmount = 0;
            if(bets[num]) winAmount += bets[num] * 36;
            // Add Color logic here if needed

            if(winAmount > 0) {
                balance += winAmount;
                updateUI();
                // You can add a floating text animation here
            }

            // Restart Game Loop after 3 seconds
            setTimeout(() => {
                startTimer();
            }, 3000);
        }

    </script>
</body>
</html>
