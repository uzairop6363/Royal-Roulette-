<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Royal Roulette - Pro</title>
    <style>
        /* --- 1. CORE & RESET --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0;
            background-color: #0d0d0d;
            font-family: 'Segoe UI', sans-serif;
            height: 100vh; width: 100vw;
            overflow: hidden;
            display: flex; flex-direction: column;
            /* Rich Casino Background */
            background: radial-gradient(circle at center, #2b0000 0%, #000 100%);
        }

        /* --- LOADING SCREEN (Keep existing logic) --- */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000 url('assets/poster_roulette.jpg') no-repeat center/cover;
            z-index: 9999; display: flex; flex-direction: column; justify-content: flex-end; align-items: center;
            padding-bottom: 80px; transition: opacity 0.8s ease-out;
        }
        .progress-container {
            width: 70%; height: 20px; border: 1px solid gold; border-radius: 10px;
            background: rgba(0,0,0,0.8); overflow: hidden;
        }
        .progress-fill { height: 100%; width: 0%; background: gold; transition: width 0.1s linear; }

        /* --- 2. GAME LAYOUT --- */
        .game-wrapper {
            position: relative; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            opacity: 0; transition: opacity 1s ease-in;
        }
        .game-wrapper.active { opacity: 1; }

        /* --- TOP: WHEEL AREA (35%) --- */
        .wheel-section {
            height: 35%;
            width: 100%;
            position: relative;
            display: flex; justify-content: center; align-items: center;
            /* Shine Effect behind wheel */
            background: radial-gradient(circle, rgba(255,215,0,0.15) 0%, transparent 70%);
            z-index: 10;
        }

        .wheel-group {
            position: relative;
            width: 260px; height: 260px;
            /* Drop shadow for 3D depth */
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.8));
        }

        .wheel-outer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2; pointer-events: none;
        }

        .wheel-spinner {
            position: absolute; top: 11%; left: 11%; width: 78%; height: 78%;
            z-index: 1; transition: transform 4s cubic-bezier(0.2, 0.8, 0.1, 1);
        }

        .ball {
            position: absolute; top: 12%; left: 50%; width: 12px; height: 12px;
            background: white; border-radius: 50%; box-shadow: 0 0 5px white;
            z-index: 3; display: none;
        }

        .pointer {
            position: absolute; top: -5px; left: 50%; transform: translateX(-50%);
            width: 30px; height: 40px;
            background: linear-gradient(to bottom, gold, #b8860b);
            clip-path: polygon(50% 100%, 0 0, 100% 0);
            z-index: 5; filter: drop-shadow(0 2px 2px #000);
        }

        /* --- MIDDLE: TABLE AREA (45%) --- */
        .table-section {
            flex-grow: 1;
            position: relative;
            width: 100%;
            overflow-y: auto; /* Scrollable Table */
            overflow-x: hidden;
            background: #003300; /* Fallback Green */
            border-top: 3px solid #b8860b;
            box-shadow: inset 0 10px 20px rgba(0,0,0,0.5);
        }
        
        .table-container {
            width: 100%;
            /* Maintain Aspect Ratio of your image roughly */
            min-height: 600px; 
            position: relative;
        }

        .table-img {
            width: 100%; height: 100%;
            display: block; object-fit: fill;
        }

        /* Grid Overlay - Perfectly aligned to your image */
        .grid-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: grid;
            /* 3 Columns + Padding sides */
            grid-template-columns: 1fr 1fr 1fr;
            padding: 13% 5% 15% 5%; /* Adjust these % to fit image borders */
            grid-auto-rows: 1fr;
            gap: 2px;
        }

        .bet-box {
            position: relative;
            /* border: 1px dashed rgba(255,255,255,0.1);  Debug Border */
        }

        /* Chip on Table Styling */
        .chip {
            position: absolute; top: 50%; left: 50%;
            width: 35px; height: 35px;
            transform: translate(-50%, -50%) scale(0);
            filter: drop-shadow(0 3px 3px rgba(0,0,0,0.6));
            animation: chipPop 0.2s forwards;
            pointer-events: none;
        }
        @keyframes chipPop { to { transform: translate(-50%, -50%) scale(1); } }

        /* --- BOTTOM: CONTROLS HUD (20%) --- */
        .hud-section {
            height: 120px;
            width: 100%;
            background: linear-gradient(to top, #1a0500, #3d0e00);
            border-top: 2px solid gold;
            display: flex; flex-direction: column; justify-content: center;
            position: relative; z-index: 50;
            padding: 5px 10px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.8);
        }

        /* Balance Badge */
        .balance-badge {
            position: absolute; top: -25px; left: 20px;
            background: linear-gradient(90deg, #000, #333);
            border: 2px solid gold; border-radius: 20px;
            padding: 5px 20px; color: gold; font-weight: bold; font-size: 16px;
            box-shadow: 0 5px 10px rgba(0,0,0,0.5);
            display: flex; gap: 5px;
        }

        /* Chips Rack */
        .chip-rack {
            display: flex; justify-content: center; gap: 15px;
            align-items: center; margin-bottom: 10px;
        }
        .chip-btn {
            width: 55px; height: 55px; cursor: pointer;
            transition: transform 0.2s; position: relative;
        }
        .chip-btn img { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 4px 4px #000); }
        
        .chip-btn.active { transform: translateY(-10px) scale(1.15); }
        .chip-btn.active::after {
            content: ''; position: absolute; bottom: -5px; left: 10%; width: 80%; height: 10px;
            background: radial-gradient(ellipse, rgba(255,215,0,0.8), transparent);
            border-radius: 50%;
        }

        /* Spin Button Area */
        .actions {
            position: absolute; bottom: 20px; right: 20px;
            display: flex; align-items: flex-end; gap: 10px;
        }
        .btn-spin {
            width: 90px; height: 90px;
            background: url('assets/btn_spin.png') no-repeat center/contain;
            border: none; cursor: pointer;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5));
            transition: transform 0.1s;
        }
        .btn-spin:active { transform: scale(0.95); filter: brightness(0.8); }

        .btn-clear {
            width: 50px; height: 50px;
            background: url('assets/btn_clear.png') no-repeat center/contain;
            border: none; cursor: pointer; margin-bottom: 5px;
        }

        /* Win Popup */
        .win-modal {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            width: 300px; height: 150px;
            background: url('assets/win_popup.png') no-repeat center/contain;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 100; transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .win-num { font-size: 60px; color: #fff; font-weight: 900; text-shadow: 0 0 10px gold; margin: 0; }
        .win-text { font-size: 20px; color: gold; font-weight: bold; text-transform: uppercase; margin-top: -5px; }

    </style>
</head>
<body>

    <div id="loader">
        <div style="color:gold; margin-bottom:10px; font-weight:bold;">LOADING CASINO...</div>
        <div class="progress-container"><div class="progress-fill" id="progressBar"></div></div>
    </div>

    <div class="game-wrapper" id="gameScreen">
        
        <div class="wheel-section">
            <div class="wheel-group">
                <div class="pointer"></div>
                <img src="assets/wheel_outer.png" class="wheel-outer">
                <img src="assets/wheel_spinner.png" class="wheel-spinner" id="spinner">
                <div class="ball" id="ball"></div>
            </div>
        </div>

        <div class="win-modal" id="winModal">
            <div class="win-num" id="winNum">0</div>
            <div class="win-text">YOU WIN!</div>
        </div>

        <div class="table-section">
            <div class="table-container">
                <img src="assets/table_layout.jpg" class="table-img">
                
                <div class="grid-layer" id="betGrid">
                    </div>
            </div>
        </div>

        <div class="hud-section">
            <div class="balance-badge">
                <span>PKR</span> <span id="balance">50000</span>
            </div>

            <div class="chip-rack">
                <div class="chip-btn active" onclick="setChip(10, 'assets/chip_10.png', this)">
                    <img src="assets/chip_10.png">
                </div>
                <div class="chip-btn" onclick="setChip(50, 'assets/chip_50.png', this)">
                    <img src="assets/chip_50.png">
                </div>
                <div class="chip-btn" onclick="setChip(100, 'assets/chip_100.png', this)">
                    <img src="assets/chip_100.png">
                </div>
                <div class="chip-btn" onclick="setChip(500, 'assets/chip_500.png', this)">
                    <img src="assets/chip_500.png">
                </div>
                <div class="chip-btn" onclick="setChip(1000, 'assets/chip_1k.png', this)">
                    <img src="assets/chip_1k.png">
                </div>
            </div>

            <div class="actions">
                <button class="btn-clear" onclick="clearTable()"></button>
                <button class="btn-spin" onclick="spin()"></button>
            </div>
        </div>

    </div>

    <script>
        // --- LOGIC ---
        window.onload = function() {
            // Loader
            let w = 0;
            const bar = document.getElementById('progressBar');
            const int = setInterval(() => {
                w+=2; bar.style.width = w+'%';
                if(w>=100) {
                    clearInterval(int);
                    document.getElementById('loader').style.opacity=0;
                    setTimeout(()=> {
                        document.getElementById('loader').style.display='none';
                        document.getElementById('gameScreen').classList.add('active');
                    },800);
                }
            }, 30);
            
            initTable();
        };

        let balance = 50000;
        let currentChip = 10;
        let currentChipImg = 'assets/chip_10.png';
        let bets = {};
        let isSpinning = false;

        // Roulette Numbers (Simplified Red Set)
        const reds = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];

        function initTable() {
            const grid = document.getElementById('betGrid');
            // Generate 36 Boxes
            for(let i=1; i<=36; i++) {
                const div = document.createElement('div');
                div.className = 'bet-box';
                div.onclick = function() { placeBet(i, this); };
                grid.appendChild(div);
            }
            // You can manually add 0, Red, Black overlay areas if needed
            // For now focused on numbers grid
        }

        function setChip(val, img, el) {
            currentChip = val; currentChipImg = img;
            document.querySelectorAll('.chip-btn').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
        }

        function placeBet(num, el) {
            if(isSpinning) return;
            if(balance < currentChip) { alert("Low Balance!"); return; }

            balance -= currentChip;
            document.getElementById('balance').innerText = balance;

            if(!bets[num]) bets[num] = 0;
            bets[num] += currentChip;

            const chip = document.createElement('img');
            chip.src = currentChipImg;
            chip.className = 'chip';
            // Random offset for realism
            chip.style.transform = `translate(-50%, -50%) translate(${Math.random()*10-5}px, ${Math.random()*10-5}px)`;
            el.appendChild(chip);
        }

        function clearTable() {
            if(isSpinning) return;
            document.querySelectorAll('.chip').forEach(c => c.remove());
            bets = {};
            // In real game you would refund, here we just clear board
        }

        function spin() {
            if(isSpinning) return;
            if(Object.keys(bets).length === 0) { alert("Place a bet!"); return; }

            isSpinning = true;
            document.getElementById('winModal').style.transform = "translate(-50%, -50%) scale(0)";

            const spinner = document.getElementById('spinner');
            const ball = document.getElementById('ball');
            const result = Math.floor(Math.random() * 37); // 0-36

            // Wheel Spin
            const deg = 1440 + Math.random() * 360;
            spinner.style.transform = `rotate(${deg}deg)`;

            // Ball Spin
            ball.style.display = 'block';
            ball.animate([
                { transform: 'rotate(0deg) translateY(100px)' },
                { transform: `rotate(-${deg + 100}deg) translateY(60px)` }
            ], { duration: 4000, easing: 'cubic-bezier(0.2,0.8,0.1,1)', fill: 'forwards' });

            setTimeout(() => {
                checkWin(result);
                isSpinning = false;
            }, 4200);
        }

        function checkWin(num) {
            const modal = document.getElementById('winModal');
            document.getElementById('winNum').innerText = num;
            modal.style.transform = "translate(-50%, -50%) scale(1)";

            let win = 0;
            if(bets[num]) win = bets[num] * 36;

            if(win > 0) {
                balance += win;
                document.getElementById('balance').innerText = balance;
                setTimeout(() => alert(`YOU WON PKR ${win}!`), 500);
            }
            
            setTimeout(() => {
                clearTable();
                modal.style.transform = "translate(-50%, -50%) scale(0)";
            }, 3000);
        }

    </script>
</body>
</html>
